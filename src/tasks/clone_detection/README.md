# Task: Clone Detection

## Problem Definition
To identify Top k codes with the same semantic. To evaluate we first extract answers from predictions and then calculate the MAP@R score, which is a mean of average precision scores.

### Input
Code and Collection of Candidates.


### Output

Top K codes with same semantic

## Input Format

Sample test file.
```
{"label": "65", "index": "0", "code": "function0"}
{"label": "65", "index": "1", "code": "function1"}
{"label": "65", "index": "2", "code": "function2"}
{"label": "66", "index": "3", "code": "function3"}
{"label": "66", "index": "4", "code": "function4"}
{"label": "66", "index": "5", "code": "function5"}
```
Each line of data file represents one function, and each row is represented as below.
 - code: the source code
 - label: the number of problem that the source code solves
 - index: the index of example



Sample answer file generated by the evaluator.
```
{"index": "0", "answers": ["1", "2"]}
{"index": "1", "answers": ["0", "2"]}
{"index": "2", "answers": ["0", "1"]}
{"index": "4", "answers": ["3", "5"]}
{"index": "3", "answers": ["4", "5"]}
{"index": "5", "answers": ["4", "3"]}
```
## How To Test
The test script for this evaulation is in the src/test/clone_detection folder. To test, run the test.py script. The output produced should match the expected.txt file.


## Evaluation Metrics 

- MAP@R score
  
## Implementation
To extract the answer file run.
```
python extract_answers.py -c test.jsonl -o answers.jsonl 
```

Then to report MAP@R score run.
```
python evaluator.py -a answers.jsonl  -p predictions.jsonl 
```


## Source

- [CodeXGLUE - Code-Code Clone Detection](https://github.com/microsoft/CodeXGLUE/tree/main/Code-Code/Clone-detection-POJ-104/evaluator)

## Contributor

Ejaz (eshaik@ncsu.edu)
